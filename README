Ported from Casalib
Revision 348
http://svn.as3.casalib.org/releases/latest/code/
